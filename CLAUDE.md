# ChallengeHub — 5-Day Trading Challenge Dashboard

## Project Purpose
Multi-day trading challenge dashboard where users complete daily tasks to progress through a 5-day challenge. Day 1 includes an exchange connection task backed by a simulated third-party API with ~30% failure rate, handled via cockatiel resilience patterns (retry + circuit breaker).

## Tech Stack
- Vue 3.5 — Composition API (`<script setup lang="ts">`)
- TypeScript 5.9 — strict mode, all strict flags enabled
- Tailwind CSS v4 — via `@tailwindcss/vite` plugin (NOT tailwind.config.js)
- shadcn-vue — new-york style, UI primitives in `src/components/ui/`
- cockatiel — retry + circuit breaker resilience patterns
- lucide-vue-next — icons
- @vueuse/core — Vue composition utilities
- reka-ui — headless primitives (used by shadcn-vue)
- Vite 7 — bundler

## Architecture — 3-Layer Pattern

### Layer 1: Services (`src/services/`) — Pure TypeScript
- **NO Vue imports.** No `ref`, `computed`, `watch`, `onMounted`, etc.
- Pure functions that take typed inputs and return typed outputs.
- Use immutable patterns: spread operators, `Array.map()`, not `Array.push()`.
- Organized by domain: `api/`, `challenge/`, `tracking/`.

### Layer 2: Composables (`src/composables/`) — Thin Reactive Wrappers
- Import `ref`, `computed` from Vue and functions from `@/services/`.
- Hold reactive state via `ref<T>()`, derive via `computed()`.
- Delegate ALL logic to service functions. No business logic here.
- Named `use*.ts`, export a single function `useSomething()`.

### Layer 3: Components (`src/components/`) — Vue SFCs
- Always `<script setup lang="ts">`.
- Props: `defineProps<{...}>()`. Emits: `defineEmits<{...}>()`.
- Keep small and focused. One responsibility per component.
- Style with Tailwind CSS utility classes only.

## File Structure
```
src/
  types/              # TypeScript interfaces (readonly props, discriminated unions)
  constants/          # Config and seed data factories
  services/
    api/              # exchangeApi.ts — mock API
    challenge/        # challengeEngine.ts — pure state transformations
    tracking/         # eventLogger.ts — structured event logging
  composables/        # useChallengeProgress, useExchangeConnection, useEventTracking, useCountdown
  components/
    ui/               # shadcn-vue auto-generated — DO NOT EDIT
    challenge/        # ChallengeBoard, DayCard, TaskItem, ProgressSummary, NextActionBanner, CompletionBanner
    exchange/         # ExchangeTask, ExchangeIdle, ExchangeConnecting, ExchangeSuccess, ExchangeError, ExchangeCircuitOpen
    layout/           # DashboardLayout, AppHeader
  lib/utils.ts        # cn() utility for Tailwind class merging
  App.vue             # Root component — wires composables to layout
  main.ts             # createApp entry point
  style.css           # Tailwind v4 directives + shadcn-vue theme variables
```

## Development Commands
```bash
npm run dev          # Start Vite dev server
npm run build        # vue-tsc type check + Vite production build
npm run preview      # Preview production build
npx vue-tsc -b --noEmit  # Type check only
npx shadcn-vue@latest add <component>  # Add shadcn-vue UI component
```

## Coding Conventions

### TypeScript
- `readonly` for immutable interface properties.
- Discriminated unions for state machines (e.g., `ExchangeStatus` with `state` discriminant).
- `import type` for type-only imports.
- Explicit return types on all functions.
- No `any` — use `unknown` with type guards.

### Vue Components
- Always `<script setup lang="ts">`. Never Options API.
- `defineProps<{...}>()` — generic syntax, no runtime declarations.
- `defineEmits<{...}>()` — typed with labeled tuple syntax.
- `computed()` for derived state.

### Tailwind CSS
- Utility classes only. Use shadcn-vue tokens: `bg-background`, `text-foreground`, `bg-muted`, etc.
- `cn()` from `@/lib/utils` for conditional class merging.
- No `tailwind.config.js` — Tailwind v4 configured in `style.css` via `@theme`.

### Imports
- `@/` alias maps to `src/`. Always use for cross-directory imports.

## Rules
1. **NEVER edit `src/components/ui/`.** Auto-generated by shadcn-vue. Use `npx shadcn-vue@latest add`.
2. **NEVER import Vue in services.** `src/services/` must have zero Vue dependencies.
3. **NEVER use Options API.** No `data()`, `methods`, `computed:`, `watch:` blocks.
4. **NEVER put business logic in components or composables.** Extract to services.
5. **NEVER use `any`.** Use `unknown` with type guards or proper generics.
6. **NEVER modify `style.css` theme variables** without understanding the shadcn-vue oklch color system.
